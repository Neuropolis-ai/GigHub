# üîí –ê–£–î–ò–¢ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò GIGHUB - –í–ï–¢–ö–ê security2605

## üìä –°–¢–ê–¢–£–° –í–´–ü–û–õ–ù–ï–ù–ò–Ø

**‚úÖ –ó–ê–í–ï–†–®–ï–ù–û: 22/22 –∑–∞–¥–∞—á (100%)**

**üéØ –í—Å–µ 5 —Ñ–∞–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:**
- ‚úÖ –§–∞–∑–∞ 1: –ê–Ω–∞–ª–∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ (–ó–∞–¥–∞—á–∏ 1-3)
- ‚úÖ –§–∞–∑–∞ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Row Level Security (–ó–∞–¥–∞—á–∏ 4-8)  
- ‚úÖ –§–∞–∑–∞ 3: –ó–∞—â–∏—Ç–∞ API routes (–ó–∞–¥–∞—á–∏ 9-15)
- ‚úÖ –§–∞–∑–∞ 4: Middleware –∏ rate limiting (–ó–∞–¥–∞—á–∏ 16-19)
- ‚úÖ –§–∞–∑–∞ 5: –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (–ó–∞–¥–∞—á–∏ 20-22)

---

## üõ°Ô∏è –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –ú–ï–†–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 1. –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–ï–ö–†–ï–¢–ê–ú–ò
- ‚úÖ –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `process.env`
- ‚úÖ –°–æ–∑–¥–∞–Ω `.env.local.example` —Å —à–∞–±–ª–æ–Ω–æ–º
- ‚úÖ `service_role` –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç hardcoded —Ç–æ–∫–µ–Ω—ã –≤ –∫–æ–¥–µ

### 2. ROW LEVEL SECURITY (RLS)
- ‚úÖ RLS –≤–∫–ª—é—á–µ–Ω –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö: `ai_services`, `categories`, `profiles`
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ —Å `auth.uid()`
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –∞–∫—Ç–∏–≤–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- ‚úÖ –ê–¥–º–∏–Ω—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–æ–ª—å `admin`
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Ñ–∏–ª–∏

### 3. API –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
- ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö endpoints
- ‚úÖ Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection)
- ‚úÖ Rate limiting –Ω–∞ –≤—Å–µ—Ö API routes
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### 4. MIDDLEWARE –ó–ê–©–ò–¢–ê
- ‚úÖ Content Security Policy (CSP)
- ‚úÖ X-Frame-Options: DENY
- ‚úÖ X-Content-Type-Options: nosniff
- ‚úÖ Strict-Transport-Security (HSTS)
- ‚úÖ Referrer-Policy
- ‚úÖ Permissions-Policy

### 5. –ê–î–ú–ò–ù–°–ö–ò–ï –§–£–ù–ö–¶–ò–ò
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ RPC —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- ‚úÖ Bulk –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

---

## üìã –î–ï–¢–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –ü–û –ó–ê–î–ê–ß–ê–ú

### –§–ê–ó–ê 1: –ê–ù–ê–õ–ò–ó –û–ö–†–£–ñ–ï–ù–ò–Ø –ò –°–ï–ö–†–ï–¢–û–í

#### ‚úÖ –ó–ê–î–ê–ß–ê 1: –ê—É–¥–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –°–æ–∑–¥–∞–Ω `.env.local.example` —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `process.env`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### ‚úÖ –ó–ê–î–ê–ß–ê 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è service_role
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- `service_role` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Å–∫—Ä–∏–ø—Ç—ã
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `anon` –∫–ª—é—á

#### ‚úÖ –ó–ê–î–ê–ß–ê 3: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ hardcoded —Å–µ–∫—Ä–µ—Ç–æ–≤
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Hardcoded —Ç–æ–∫–µ–Ω—ã –ù–ï –ù–ê–ô–î–ï–ù–´ ‚úÖ

### –§–ê–ó–ê 2: –ù–ê–°–¢–†–û–ô–ö–ê ROW LEVEL SECURITY

#### ‚úÖ –ó–ê–î–ê–ß–ê 4: –í–∫–ª—é—á–µ–Ω–∏–µ RLS –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** RLS –≤–∫–ª—é—á–µ–Ω –Ω–∞ `ai_services`, `categories`, `profiles`

#### ‚úÖ –ó–ê–î–ê–ß–ê 5: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã profiles
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å —Ä–æ–ª—è–º–∏ `user`, `admin`, `moderator`

#### ‚úÖ –ó–ê–î–ê–ß–ê 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è ai_services
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –∞–∫—Ç–∏–≤–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º
- CUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤/–º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤

#### ‚úÖ –ó–ê–î–ê–ß–ê 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è categories
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- CUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

#### ‚úÖ –ó–ê–î–ê–ß–ê 8: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è profiles
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Ñ–∏–ª–∏
- –ê–¥–º–∏–Ω—ã –≤–∏–¥—è—Ç –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏

### –§–ê–ó–ê 3: –ó–ê–©–ò–¢–ê API ROUTES

#### ‚úÖ –ó–ê–î–ê–ß–ê 9: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Zod
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Zod —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

#### ‚úÖ –ó–ê–î–ê–ß–ê 10: –°–æ–∑–¥–∞–Ω–∏–µ auth middleware
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω `lib/auth.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `verifyJWT()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–æ–≤
- `requireAuth()` - —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `requireAdmin()` - —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤
- `getClientIP()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ IP –¥–ª—è rate limiting

#### ‚úÖ –ó–ê–î–ê–ß–ê 11: –°–æ–∑–¥–∞–Ω–∏–µ Zod —Å—Ö–µ–º
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω `lib/validations.ts` —Å–æ —Å—Ö–µ–º–∞–º–∏ –¥–ª—è:
- AI —Å–µ—Ä–≤–∏—Å–æ–≤ (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- –ö–∞—Ç–µ–≥–æ—Ä–∏–π (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- –ü—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- –ê–¥–º–∏–Ω—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

#### ‚úÖ –ó–ê–î–ê–ß–ê 12: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API ai-services
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Å:
- JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –¥–ª—è CUD –æ–ø–µ—Ä–∞—Ü–∏–π
- Zod –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- Rate limiting (200 GET, 50 POST/PUT/DELETE –≤ –º–∏–Ω—É—Ç—É)
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

#### ‚úÖ –ó–ê–î–ê–ß–ê 13: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API categories
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Å –ø–æ–ª–Ω–æ–π –∑–∞—â–∏—Ç–æ–π

#### ‚úÖ –ó–ê–î–ê–ß–ê 14: –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω—Å–∫–∏—Ö endpoints
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω—ã:
- `/api/admin/users` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/api/admin/services` - –º–æ–¥–µ—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ —Å bulk –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

#### ‚úÖ –ó–ê–î–ê–ß–ê 15: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏ SQL
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Supabase –º–µ—Ç–æ–¥—ã (–∑–∞—â–∏—â–µ–Ω—ã –æ—Ç SQL injection)

### –§–ê–ó–ê 4: MIDDLEWARE –ò RATE LIMITING

#### ‚úÖ –ó–ê–î–ê–ß–ê 16: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ middleware.ts
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–±–∞–≤–ª–µ–Ω—ã security headers:
- Content Security Policy
- X-Frame-Options: DENY
- X-Content-Type-Options: nosniff
- Strict-Transport-Security
- Referrer-Policy
- Permissions-Policy

#### ‚úÖ –ó–ê–î–ê–ß–ê 17: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è rate limiting
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** In-memory rate limiting –Ω–∞ –≤—Å–µ—Ö API routes:
- GET: 200 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- POST/PUT: 10-50 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- DELETE: 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- –ê–¥–º–∏–Ω—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: 5-10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É

#### ‚úÖ –ó–ê–î–ê–ß–ê 18: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ middleware –¥–ª—è API routes

#### ‚úÖ –ó–ê–î–ê–ß–ê 19: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å IP –∏ User-Agent

### –§–ê–ó–ê 5: –§–ò–ù–ê–õ–¨–ù–û–ï –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–ï –ò –í–ï–†–ò–§–ò–ö–ê–¶–ò–Ø

#### ‚úÖ –ó–ê–î–ê–ß–ê 20: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ Next.js
- –û–±–Ω–æ–≤–ª–µ–Ω –¥–æ –≤–µ—Ä—Å–∏–∏ 14.2.29
- –û—Å—Ç–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ 1 –Ω–∏–∑–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å (dev server)

#### ‚úÖ –ó–ê–î–ê–ß–ê 21: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–∫–∞–∑–∞–ª–∞:
- ‚úÖ RLS –≤–∫–ª—é—á–µ–Ω –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- ‚úÖ 12 –ø–æ–ª–∏—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ã
- ‚úÖ 3 RPC —Ñ—É–Ω–∫—Ü–∏–∏ —Å SECURITY DEFINER

#### ‚úÖ –ó–ê–î–ê–ß–ê 22: –§–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –≠—Ç–æ—Ç –æ—Ç—á–µ—Ç

---

## üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –í–ï–†–ò–§–ò–ö–ê–¶–ò–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### RLS –°–¢–ê–¢–£–°
```sql
ai_services    | RLS –≤–∫–ª—é—á–µ–Ω ‚úì
categories     | RLS –≤–∫–ª—é—á–µ–Ω ‚úì  
profiles       | RLS –≤–∫–ª—é—á–µ–Ω ‚úì
```

### –ü–û–õ–ò–¢–ò–ö–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò (12 –∞–∫—Ç–∏–≤–Ω—ã—Ö)
```sql
ai_services:
- ai_services_select_public (SELECT –¥–ª—è –≤—Å–µ—Ö)
- ai_services_insert_auth (INSERT –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)
- ai_services_update_owner_admin (UPDATE –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- ai_services_delete_admin (DELETE –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

categories:
- categories_select_all (SELECT –¥–ª—è –≤—Å–µ—Ö)
- categories_insert_admin (INSERT –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- categories_update_admin (UPDATE –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- categories_delete_admin (DELETE –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

profiles:
- profiles_select_own (SELECT —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è)
- profiles_insert_own (INSERT —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è)
- profiles_update_own (UPDATE —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è)
- profiles_admin_view_all (SELECT –≤—Å–µ—Ö –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
```

### RPC –§–£–ù–ö–¶–ò–ò (3 –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ)
```sql
get_all_users      | SECURITY DEFINER ‚úì
change_user_role   | SECURITY DEFINER ‚úì
handle_new_user    | SECURITY DEFINER ‚úì
```

---

## üìÅ –°–û–ó–î–ê–ù–ù–´–ï/–û–ë–ù–û–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
1. `lib/auth.ts` - JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
2. `lib/validations.ts` - Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. `app/api/admin/users/route.ts` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
4. `app/api/admin/services/route.ts` - –ú–æ–¥–µ—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
5. `.env.local.example` - –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
6. `rls-setup.sql` - SQL —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ RLS

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. `app/api/ai-services/route.ts` - –ü–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞ API
2. `app/api/categories/route.ts` - –ü–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞ API
3. `middleware.ts` - Security headers
4. `scripts/import-csv-data.js` - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
1. `enable_rls_security` - –í–∫–ª—é—á–µ–Ω–∏–µ RLS
2. `setup_rls_policies` - –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è ai_services
3. `setup_categories_policies` - –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è categories
4. `setup_profiles_policies` - –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è profiles
5. `setup_triggers_and_functions` - RPC —Ñ—É–Ω–∫—Ü–∏–∏
6. `fix_admin_functions` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –ü–†–û–î–ê–ö–®–ï–ù–ê

### 1. RATE LIMITING
- –ó–∞–º–µ–Ω–∏—Ç—å in-memory rate limiting –Ω–∞ Redis
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–æ–ª–µ–µ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ —Ä–æ–ª—è–º

### 2. –ú–û–ù–ò–¢–û–†–ò–ù–ì
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É

### 3. BACKUP –ò RECOVERY
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### 4. SSL/TLS
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### 5. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ó–ê–©–ò–¢–ê
- Web Application Firewall (WAF)
- DDoS –∑–∞—â–∏—Ç–∞
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–µ–Ω—Ç–µ—Å—Ç—ã

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GigHub —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!**

–í—Å–µ 22 –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â–µ–Ω–∞ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö:
- üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
- üõ°Ô∏è Row Level Security  
- üîí API –∑–∞—â–∏—Ç–∞ —Å JWT + Zod
- ‚ö° Rate limiting
- üö´ Security headers
- üë• –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–∞

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!**

---

*–ê—É–¥–∏—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω: 26 –¥–µ–∫–∞–±—Ä—è 2024*  
*–í–µ—Ç–∫–∞: security2605*  
*–°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù* 